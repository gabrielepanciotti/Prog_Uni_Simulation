<pre><font color="#5a5a5a">;environment</font><font color="#000000"><br /></font><font color="#007f69">globals</font><font color="#000000"> [<br />  membrane-edge-x  </font><font color="#5a5a5a">;; horizontal distance from center to edge of membrane</font><font color="#000000"><br />  membrane-edge-y  </font><font color="#5a5a5a">;; vertical distance from center to edge of membrane</font><font color="#000000"><br />]<br /></font><font color="#5a5a5a">;agents based on model</font><font color="#000000"><br /></font><font color="#5a5a5a">;it is based on model because whit the sensors it knows what the world is like now, where it is and where the</font><font color="#000000"><br /></font><font color="#5a5a5a">;4 neighbours is,how much is the friction/stiffness but it does the action not only for the actual perception</font><font color="#000000"><br /></font><font color="#5a5a5a">;but even for condition-action rules like: if it is an edge it has a behavior, if it is a driver another behavior.</font><font color="#000000"><br /></font><font color="#5a5a5a">;We can say that the behavior of the turtle-driver is to set the rest of the membrane in motion but the behavior</font><font color="#000000"><br /></font><font color="#5a5a5a">;of the membrane itself tends to bring equilibrium, as it tries to decrease the difference between neighboring agents</font><font color="#000000"><br /></font><font color="#007f69">turtles-own</font><font color="#000000"> [<br />  edge?            </font><font color="#5a5a5a">;; are we on the edge of the membrane?</font><font color="#000000"><br />  driver?          </font><font color="#5a5a5a">;; are we part of the green driving plate?</font><font color="#000000"><br />  x                </font><font color="#5a5a5a">;; position on x axis in space</font><font color="#000000"><br />  y                </font><font color="#5a5a5a">;; position on y axis in space</font><font color="#000000"><br />  z                </font><font color="#5a5a5a">;; position on z axis in space</font><font color="#000000"><br />  velocity-z         </font><font color="#5a5a5a">;; velocity along z axis</font><font color="#000000"><br />  velocity-x         </font><font color="#5a5a5a">;; velocity along x axis</font><font color="#000000"><br />  velocity-y         </font><font color="#5a5a5a">;; velocity along y axis</font><font color="#000000"><br />  neighbor-turtles </font><font color="#5a5a5a">;; agentset of turtles adjacent to us</font><font color="#000000"><br />]<br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  </font><font color="#5a5a5a">;create the membrane</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> membrane-edge-x </font><font color="#660096">floor</font><font color="#000000"> (</font><font color="#660096">max-pxcor</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)<br />  </font><font color="#0000aa">set</font><font color="#000000"> membrane-edge-y </font><font color="#660096">floor</font><font color="#000000"> (</font><font color="#660096">max-pycor</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)<br />  </font><font color="#0000aa">set-default-shape</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000"><br />  </font><font color="#5a5a5a">;for all the patches in the mebrane create a turtle(point)</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(</font><font color="#660096">abs</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> membrane-edge-x) </font><font color="#660096">and</font><font color="#000000"><br />                    (</font><font color="#660096">abs</font><font color="#000000"> </font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> membrane-edge-y)]<br />    [ </font><font color="#0000aa">sprout</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />        </font><font color="#5a5a5a">;set edge if it is in the edge of the membrane and color blue</font><font color="#000000"><br />        [ </font><font color="#0000aa">set</font><font color="#000000"> edge? (</font><font color="#660096">abs</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> membrane-edge-x) </font><font color="#660096">or</font><font color="#000000"><br />                    (</font><font color="#660096">abs</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> membrane-edge-y)<br />          </font><font color="#0000aa">if</font><font color="#000000"> edge? [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> ]<br />          </font><font color="#5a5a5a">;set driver if its in the driver and color green</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> driver? (</font><font color="#660096">abs</font><font color="#000000"> (</font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> driver-x) </font><font color="#660096">&lt;=</font><font color="#000000"> driver-size) </font><font color="#660096">and</font><font color="#000000"><br />                      (</font><font color="#660096">abs</font><font color="#000000"> (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> driver-y) </font><font color="#660096">&lt;=</font><font color="#000000"> driver-size)<br />          </font><font color="#0000aa">if</font><font color="#000000"> driver? [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"> ]<br />          </font><font color="#5a5a5a">;set the position of the turtle</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> x </font><font color="#660096">xcor</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> y </font><font color="#660096">ycor</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> z </font><font color="#963700">0</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> velocity-x </font><font color="#963700">0</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> velocity-y </font><font color="#963700">0</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> velocity-z </font><font color="#963700">0</font><font color="#000000"><br />          recolor ] ]<br />  </font><font color="#5a5a5a">;for each turtles set the neighbor</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> neighbor-turtles </font><font color="#660096">turtles-on</font><font color="#000000"> </font><font color="#660096">neighbors4</font><font color="#000000"> ]<br />  project<br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> recolor  </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> edge? </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> driver?<br />    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">scale-color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"> z </font><font color="#963700">-20</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000"> ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />  </font><font color="#5a5a5a">;for each turtles that are not a driver or a edge --&gt;propagate</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> driver? </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> edge?]<br />    [ propagate ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />    [ </font><font color="#0000aa">ifelse</font><font color="#000000"> driver?<br />        [ </font><font color="#0000aa">set</font><font color="#000000"> z (driver-amplitude-z </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">sin</font><font color="#000000"> (</font><font color="#963700">0.1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> driver-frequency </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000">)))<br />        </font><font color="#0000aa">set</font><font color="#000000"> x (driver-amplitude-x </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">sin</font><font color="#000000"> (</font><font color="#963700">0.1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> driver-frequency </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000">)))<br />        </font><font color="#0000aa">set</font><font color="#000000"> y (driver-amplitude-y </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">sin</font><font color="#000000"> (</font><font color="#963700">0.1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> driver-frequency </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000">))) ]<br />        [ </font><font color="#0000aa">set</font><font color="#000000"> z (z </font><font color="#660096">+</font><font color="#000000"> velocity-z)<br />        </font><font color="#0000aa">set</font><font color="#000000"> x (x </font><font color="#660096">+</font><font color="#000000"> velocity-x)<br />        </font><font color="#0000aa">set</font><font color="#000000"> y (y </font><font color="#660096">+</font><font color="#000000"> velocity-y)<br />          recolor ] ]<br />  project<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> propagate   </font><font color="#5a5a5a">;; turtle procedure -- propagates the wave from neighboring turtles</font><font color="#000000"><br />  </font><font color="#5a5a5a">;the velocity of the turtles is set each ticket with the velocity the ticks before plus the stiffness and</font><font color="#000000"><br />  </font><font color="#5a5a5a">;the difference in position between the turtles and its 4 neighbors, if the turtles is far from the others,</font><font color="#000000"><br />  </font><font color="#5a5a5a">;this difference become negative so its velocity is reduced,finally this value is multiplied whit the friction</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> velocity-z (velocity-z </font><font color="#660096">+</font><font color="#000000"><br />                 (stiffness </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.01</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"><br />                   (</font><font color="#660096">sum</font><font color="#000000"> [z] </font><font color="#660096">of</font><font color="#000000"> neighbor-turtles<br />                    </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> z)))<br />  </font><font color="#0000aa">set</font><font color="#000000"> velocity-z (((</font><font color="#963700">1000</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> friction) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">1000</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> velocity-z)<br />  </font><font color="#0000aa">set</font><font color="#000000"> velocity-x (velocity-x </font><font color="#660096">+</font><font color="#000000"><br />                 (stiffness </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.01</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"><br />                   (</font><font color="#660096">sum</font><font color="#000000"> [x] </font><font color="#660096">of</font><font color="#000000"> neighbor-turtles<br />                    </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> x)))<br />  </font><font color="#0000aa">set</font><font color="#000000"> velocity-x (((</font><font color="#963700">1000</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> friction) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">1000</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> velocity-x)<br />  </font><font color="#5a5a5a">;having added motion in the x- and y-axis, the force moving the agent could take them out of the environment,</font><font color="#000000"><br />  </font><font color="#5a5a5a">;so I added controls, which gradually decrease the agent's speed the closer it gets to the edges of the environment</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> x </font><font color="#660096">&gt;</font><font color="#000000"> membrane-edge-x </font><font color="#660096">or</font><font color="#000000"> x </font><font color="#660096">&lt;</font><font color="#000000"> (membrane-edge-x </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000">)<br />  [ </font><font color="#0000aa">set</font><font color="#000000"> velocity-x velocity-x </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.9</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> x </font><font color="#660096">&gt;</font><font color="#000000"> (membrane-edge-x </font><font color="#660096">+</font><font color="#000000"> membrane-edge-x </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> x </font><font color="#660096">&lt;</font><font color="#000000"> (membrane-edge-x </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000">)<br />  [ </font><font color="#0000aa">set</font><font color="#000000"> velocity-x velocity-x </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.7</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> x </font><font color="#660096">&gt;</font><font color="#000000"> (membrane-edge-x </font><font color="#660096">+</font><font color="#000000"> membrane-edge-x </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.75</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> x </font><font color="#660096">&lt;</font><font color="#000000"> (membrane-edge-x </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.75</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000">)<br />  [ </font><font color="#0000aa">set</font><font color="#000000"> velocity-x velocity-x </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.1</font><font color="#000000"> ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> velocity-y (velocity-y </font><font color="#660096">+</font><font color="#000000"><br />                 (stiffness </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.01</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"><br />                   (</font><font color="#660096">sum</font><font color="#000000"> [y] </font><font color="#660096">of</font><font color="#000000"> neighbor-turtles<br />                    </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> y)))<br />  </font><font color="#0000aa">set</font><font color="#000000"> velocity-y (((</font><font color="#963700">1000</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> friction) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">1000</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> velocity-y)<br />  </font><font color="#0000aa">if</font><font color="#000000"> y </font><font color="#660096">&gt;</font><font color="#000000"> membrane-edge-y </font><font color="#660096">or</font><font color="#000000"> y </font><font color="#660096">&lt;</font><font color="#000000"> (membrane-edge-y </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pycor</font><font color="#000000">)<br />  [ </font><font color="#0000aa">set</font><font color="#000000"> velocity-y velocity-y </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.9</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> y </font><font color="#660096">&gt;</font><font color="#000000"> (membrane-edge-y </font><font color="#660096">+</font><font color="#000000"> membrane-edge-y </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> y </font><font color="#660096">&lt;</font><font color="#000000"> (membrane-edge-y </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pycor</font><font color="#000000">)<br />  [ </font><font color="#0000aa">set</font><font color="#000000"> velocity-y velocity-y </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.7</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> y </font><font color="#660096">&gt;</font><font color="#000000"> (membrane-edge-y </font><font color="#660096">+</font><font color="#000000"> membrane-edge-y </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.75</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> y </font><font color="#660096">&lt;</font><font color="#000000"> (membrane-edge-y </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.75</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pycor</font><font color="#000000">)<br />  [ </font><font color="#0000aa">set</font><font color="#000000"> velocity-y velocity-y </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.1</font><font color="#000000"> ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; procedures for displaying in 2-D or 3-D</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> project<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> three-d?<br />    [ project-3d ]<br />    [ project-2d ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> project-3d<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#0000aa">let</font><font color="#000000"> xc (x </font><font color="#660096">+</font><font color="#000000"> (</font><font color="#660096">cos</font><font color="#000000"> view-angle) </font><font color="#660096">*</font><font color="#000000"> y)<br />    </font><font color="#0000aa">let</font><font color="#000000"> yc (z </font><font color="#660096">+</font><font color="#000000"> (</font><font color="#660096">sin</font><font color="#000000"> view-angle) </font><font color="#660096">*</font><font color="#000000"> y)<br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">patch-at</font><font color="#000000"> (xc </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000">) (yc </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000">) </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"><br />    [ </font><font color="#0000aa">setxy</font><font color="#000000">  xc yc<br />      </font><font color="#0000aa">show-turtle</font><font color="#000000"> ]<br />    [ </font><font color="#0000aa">hide-turtle</font><font color="#000000"> ]<br />    recolor<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> project-2d<br />  </font><font color="#5a5a5a">;; Set our viewable x and y coordinates to be the same as our real</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; coordinates.  This is only needed for if the user turns THREE-D?</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; off while the model is running.</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />    [ </font><font color="#0000aa">setxy</font><font color="#000000"> x y<br />      recolor<br />      </font><font color="#0000aa">show-turtle</font><font color="#000000"> ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">; Copyright 1997 Uri Wilensky.</font><font color="#000000"><br /></font><font color="#5a5a5a">; See Info tab for full copyright and license.</font>
</pre>
